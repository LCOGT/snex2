{% extends 'tom_common/base.html' %}
{% load static gw_tags bootstrap4 crispy_forms_tags targets_extras custom_code_tags %}
{% block title %}Galaxy List{% endblock %}
{% block additional_css %}
<link rel="stylesheet" href="{% static 'tom_targets/css/targets_snexclone.css' %}">
{% endblock %}
{% block content %}
<nav class="navbar navbar-expand-md fixed-top fixed-top-2">
  <div class="collapse navbar-collapse" id="targetInfo">
    <h3>Galaxy List for {{ superevent_id }}</h3>
  </div>
</nav>
{% if user|has_gw_permissions %}
<div class="row">
  <div class="col-md-6">
    <span class="float-left">{% crispy obs_form %}</span>
  </div>
  <div class="col-md-6" id="btn-div">
    <div class="row">
      <div class="col-md-6"><button id="submit-btn" class="btn" style="vertical-align: middle; width: 200px; height: 80px; background-color: rgb(0, 114, 54); border: 1px solid black; color: white; cursor: default;" disabled>Submit Observations</button></div>
      <div class="col-md-6"><button id="cancel-btn" class="btn" style="vertical-align: middle; width: 200px; height: 80px; background-color: rgb(114, 0, 0); border: 1px solid black; color: white; cursor: default;" disabled>Cancel All Observations</button></div>
    </div>
    <div class="row">
      <div class="col-md-6"><input type="checkbox" onclick='toggleButton("submit-btn")'><span>Check if ready to submit</span></div>
      <div class="col-md-6"><input type="checkbox" onclick='toggleButton("cancel-btn")'><span>Check if ready to cancel</span></div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-6">
    {% bootstrap_pagination page_obj extra=request.GET.urlencode %}
  </div>
  <div class="col-md-6">
    <span class="float-left">{{ galaxy_count }} Galaxies &nbsp;</span>
  </div>
</div>
<table class="table">
  <thead class="thead-light">
    <tr>
      <th><br /><p></p></th>
      <th>Name<br /><p></p></th>
      <th>Score<br /><p></p></th>
      <th>RA<br /><p></p></th>
      <th>Dec<br /><p></p></th>
      <th>Distance<br /><p></p></th>
      <th>Visibility<br /><p></p></th>
      <th>Reference<br /><p></p></th>
    </tr>
  </thead>
  <tbody>
  {% for galaxy in galaxies %}
    <tr>
      <td><b>{{ page_obj.start_index|add:forloop.counter0 }}.</b></td>
      <td>{{ galaxy.catalog_objname }}</td>
      <td>{{ galaxy.score|floatformat:4 }}</td>
      <td>{{ galaxy.ra|floatformat:4 }}</td>
      <td>{{ galaxy.dec|floatformat:4 }}</td>
      <td>{{ galaxy.dist|floatformat:0 }} Mpc</td>
      <td>{% airmass_collapse galaxy %}</td>
      <td style="border-top:none;">
        <div id="aladin-{{ galaxy.id }}" style="display: inline-block;">{% aladin_collapse galaxy %}</div>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% bootstrap_pagination page_obj extra=request.GET.urlencode %}
{% endif %}
<script>
function toggleButton(btnId) {
  var specifiedBtn = document.getElementById(btnId);
  if (specifiedBtn.disabled === true) {
    specifiedBtn.disabled = false;
    specifiedBtn.style.cursor = "pointer";
  } else {
    specifiedBtn.disabled = true;
    specifiedBtn.style.cursor = "default";
  }
}
</script>
{% endblock content %}
